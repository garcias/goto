<h1> Rosters </h1>

<em> A bookmarklet to parse and download Private Pages rosters. Updated as of 2020-08-21. </em>

<h2> What it does </h2>

<ul>
  <li> Parses the rosters of students on Private Pages to get subject, number, student ID, name, email. </li>
  <li> Organizes into a table and downloads a TSV file (uses artoo.js to create download file). </li>
</ul>

<h2> How to install it </h2>

<p> Drag this link to your bookmarks bar: 
  <a href="
    javascript:%20(function(e){var%20t={eval:'"all_text=[],document.querySelectorAll(\\"pre\\").forEach((function(e){all_text+=e.textContent})),lines=all_text.match(/..*?[SE][A-Z]*?[0-9]{6}.*/g),data=lines.map(e=%3E{if(courses_found=e.match(/[A-Z]{3,5}\\\\,\\\\%20[0-9]{3}[A-Z]?\\\\.[0-9]{1,2}/),null!==courses_found&&(course=courses_found[0].split(\\%22,%20\\%22,2)),names_found=e.match(/[SE][A-Z]*?[0-9]{6}\\\\%20{3}.*?(?=\\\\%20\\\\%20)/),null!==names_found)return%20sid=names_found[0].match(/[SE][A-Z]*?[0-9]{6}/)[0],name=names_found[0].replace(/[SE][A-Z]*?[0-9]{6}\\\\%20{3}/,\\%22\\%22),email=e.match(/\\\\%20([a-z]+?[0-9]*?\\\\@kenyon.edu)/)[1],{subj:course[0],no:course[1],sid:sid,name:name,email:email}}),artoo.saveTsv(data);%22'},a=!0;if(%22object%22==typeof%20this.artoo&&(artoo.settings.reload||(artoo.log.verbose(%22artoo%20already%20exists%20within%20this%20page.%20No%20need%20to%20inject%20him%20again.%22),artoo.loadSettings(t),artoo.exec(),a=!1)),a){var%20o=document.getElementsByTagName(%22body%22)[0];o||(o=document.createElement(%22body%22),document.firstChild.appendChild(o));var%20n=document.createElement(%22script%22);console.log(%22artoo.js%20is%20loading...%22),n.src=%22//medialab.github.io/artoo/public/dist/artoo-latest.min.js%22,n.type=%22text/javascript%22,n.id=%22artoo_injected_script%22,n.setAttribute(%22settings%22,JSON.stringify(t)),o.appendChild(n)}}).call(this);
  "> rosters </a>
</p>

<h2> How to use it </h2>

<ul>
  <li> Go to Private Pages and acces course rosters for the desired semester. </li>
  <li> Click the bookmarklet. </li>
  <li> Import the resulting .tsv file into spreadsheet software. </li>
</ul>
